<!DOCTYPE html>
<html>
<head>
  <title>Council Dashboard</title>
  <style>
    body {
      font-family: Arial;
      background: #f4f6f8;
      padding: 20px;
    }
    .card {
      background: #fff;
      padding: 15px;
      margin: 15px auto;
      max-width: 600px;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    button {
      padding: 6px 12px;
      background: green;
      color: #fff;
      border: none;
      cursor: pointer;
      margin-top: 10px;
    }
  </style>
</head>

<body>

<h2>üßë‚Äç‚öñÔ∏è Council Dashboard</h2>

<div id="complaints">Loading...</div>

<script>
const API = "http://localhost:51078/complaints";

function loadComplaints() {
  fetch(API)
    .then(res => res.json())
    .then(data => {
      const div = document.getElementById("complaints");
      div.innerHTML = "";

      data.forEach(c => {
        div.innerHTML += `
          <div class="card">
            <h3>${c.title}</h3>
            <p>${c.description}</p>
            <p><b>Location:</b> ${c.location}</p>
            <p><b>Status:</b> ${c.status}</p>
            ${
              c.status !== "Resolved"
              ? `<button onclick="resolveComplaint('${c._id}')">
                   Mark as Resolved
                 </button>`
              : ""
            }
          </div>
        `;
      });
    });
}

function resolveComplaint(id) {
  fetch(`${API}/${id}`, {
    method: "PUT",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({ status: "Resolved" })
  })
  .then(res => res.json())
  .then(() => {
    alert("Status updated ‚úÖ");
    loadComplaints();
  });
}

loadComplaints();
</script>

</body>
</html>
